{"ast":null,"code":"\"use strict\";\n\nvar _slicedToArray = require(\"C:/Users/raphm/Documents/Projects/youtube-transcript/youtube-transcript/node_modules/@babel/runtime/helpers/slicedToArray.js\").default;\nvar _createForOfIteratorHelper = require(\"C:/Users/raphm/Documents/Projects/youtube-transcript/youtube-transcript/node_modules/@babel/runtime/helpers/createForOfIteratorHelper.js\").default;\nvar _regeneratorRuntime = require(\"C:/Users/raphm/Documents/Projects/youtube-transcript/youtube-transcript/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\").default;\nvar _asyncToGenerator = require(\"C:/Users/raphm/Documents/Projects/youtube-transcript/youtube-transcript/node_modules/@babel/runtime/helpers/asyncToGenerator.js\").default;\nvar _objectSpread = require(\"C:/Users/raphm/Documents/Projects/youtube-transcript/youtube-transcript/node_modules/@babel/runtime/helpers/objectSpread2.js\").default;\nvar _classCallCheck = require(\"C:/Users/raphm/Documents/Projects/youtube-transcript/youtube-transcript/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\nvar _createClass = require(\"C:/Users/raphm/Documents/Projects/youtube-transcript/youtube-transcript/node_modules/@babel/runtime/helpers/createClass.js\").default;\nvar _assertThisInitialized = require(\"C:/Users/raphm/Documents/Projects/youtube-transcript/youtube-transcript/node_modules/@babel/runtime/helpers/assertThisInitialized.js\").default;\nvar _inherits = require(\"C:/Users/raphm/Documents/Projects/youtube-transcript/youtube-transcript/node_modules/@babel/runtime/helpers/inherits.js\").default;\nvar _createSuper = require(\"C:/Users/raphm/Documents/Projects/youtube-transcript/youtube-transcript/node_modules/@babel/runtime/helpers/createSuper.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.MongoClient = exports.ServerApiVersion = void 0;\nvar fs_1 = require(\"fs\");\nvar util_1 = require(\"util\");\nvar bson_1 = require(\"./bson\");\nvar change_stream_1 = require(\"./change_stream\");\nvar mongo_credentials_1 = require(\"./cmap/auth/mongo_credentials\");\nvar providers_1 = require(\"./cmap/auth/providers\");\nvar connection_string_1 = require(\"./connection_string\");\nvar constants_1 = require(\"./constants\");\nvar db_1 = require(\"./db\");\nvar error_1 = require(\"./error\");\nvar mongo_logger_1 = require(\"./mongo_logger\");\nvar mongo_types_1 = require(\"./mongo_types\");\nvar execute_operation_1 = require(\"./operations/execute_operation\");\nvar run_command_1 = require(\"./operations/run_command\");\nvar read_preference_1 = require(\"./read_preference\");\nvar server_selection_1 = require(\"./sdam/server_selection\");\nvar topology_1 = require(\"./sdam/topology\");\nvar sessions_1 = require(\"./sessions\");\nvar utils_1 = require(\"./utils\");\n/** @public */\nexports.ServerApiVersion = Object.freeze({\n  v1: '1'\n});\n/** @internal */\nvar kOptions = Symbol('options');\n/**\n * The **MongoClient** class is a class that allows for making Connections to MongoDB.\n * @public\n *\n * @remarks\n * The programmatically provided options take precedence over the URI options.\n *\n * @example\n * ```ts\n * import { MongoClient } from 'mongodb';\n *\n * // Enable command monitoring for debugging\n * const client = new MongoClient('mongodb://localhost:27017', { monitorCommands: true });\n *\n * client.on('commandStarted', started => console.log(started));\n * client.db().collection('pets');\n * await client.insertOne({ name: 'spot', kind: 'dog' });\n * ```\n */\nvar MongoClient = /*#__PURE__*/function (_mongo_types_1$TypedE) {\n  _inherits(MongoClient, _mongo_types_1$TypedE);\n  var _super = _createSuper(MongoClient);\n  function MongoClient(url, options) {\n    var _this;\n    _classCallCheck(this, MongoClient);\n    _this = _super.call(this);\n    _this[kOptions] = (0, connection_string_1.parseOptions)(url, _assertThisInitialized(_this), options);\n    _this.mongoLogger = new mongo_logger_1.MongoLogger(_this[kOptions].mongoLoggerOptions);\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    var client = _assertThisInitialized(_this);\n    // The internal state\n    _this.s = {\n      url: url,\n      bsonOptions: (0, bson_1.resolveBSONOptions)(_this[kOptions]),\n      namespace: (0, utils_1.ns)('admin'),\n      hasBeenClosed: false,\n      sessionPool: new sessions_1.ServerSessionPool(_assertThisInitialized(_this)),\n      activeSessions: new Set(),\n      get options() {\n        return client[kOptions];\n      },\n      get readConcern() {\n        return client[kOptions].readConcern;\n      },\n      get writeConcern() {\n        return client[kOptions].writeConcern;\n      },\n      get readPreference() {\n        return client[kOptions].readPreference;\n      },\n      get isMongoClient() {\n        return true;\n      }\n    };\n    return _this;\n  }\n  /** @see MongoOptions */\n  _createClass(MongoClient, [{\n    key: \"options\",\n    get: function get() {\n      return Object.freeze(_objectSpread({}, this[kOptions]));\n    }\n  }, {\n    key: \"serverApi\",\n    get: function get() {\n      return this[kOptions].serverApi && Object.freeze(_objectSpread({}, this[kOptions].serverApi));\n    }\n    /**\n     * Intended for APM use only\n     * @internal\n     */\n  }, {\n    key: \"monitorCommands\",\n    get: function get() {\n      return this[kOptions].monitorCommands;\n    },\n    set: function set(value) {\n      this[kOptions].monitorCommands = value;\n    }\n    /** @internal */\n  }, {\n    key: \"autoEncrypter\",\n    get: function get() {\n      return this[kOptions].autoEncrypter;\n    }\n  }, {\n    key: \"readConcern\",\n    get: function get() {\n      return this.s.readConcern;\n    }\n  }, {\n    key: \"writeConcern\",\n    get: function get() {\n      return this.s.writeConcern;\n    }\n  }, {\n    key: \"readPreference\",\n    get: function get() {\n      return this.s.readPreference;\n    }\n  }, {\n    key: \"bsonOptions\",\n    get: function get() {\n      return this.s.bsonOptions;\n    }\n    /**\n     * Connect to MongoDB using a url\n     *\n     * @see docs.mongodb.org/manual/reference/connection-string/\n     */\n  }, {\n    key: \"connect\",\n    value: function () {\n      var _connect2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              if (!this.connectionLock) {\n                _context.next = 2;\n                break;\n              }\n              return _context.abrupt(\"return\", this.connectionLock);\n            case 2:\n              _context.prev = 2;\n              this.connectionLock = this._connect();\n              _context.next = 6;\n              return this.connectionLock;\n            case 6:\n              _context.prev = 6;\n              // release\n              this.connectionLock = undefined;\n              return _context.finish(6);\n            case 9:\n              return _context.abrupt(\"return\", this);\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this, [[2,, 6, 9]]);\n      }));\n      function connect() {\n        return _connect2.apply(this, arguments);\n      }\n      return connect;\n    }()\n    /**\n     * Create a topology to open the connection, must be locked to avoid topology leaks in concurrency scenario.\n     * Locking is enforced by the connect method.\n     *\n     * @internal\n     */\n  }, {\n    key: \"_connect\",\n    value: function () {\n      var _connect3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var _options$credentials,\n          _this2 = this;\n        var options, _options$ca, _options$crl, _options$key, _options$cert, contents, hosts, _iterator, _step, _step$value, index, host, _options$credentials2, _options$credentials3, allowedHosts, isServiceAuth, _iterator2, _step2, _host, _iterator3, _step3, _loop, topologyConnect, _this$autoEncrypter;\n        return _regeneratorRuntime().wrap(function _callee3$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              if (!(this.topology && this.topology.isConnected())) {\n                _context4.next = 2;\n                break;\n              }\n              return _context4.abrupt(\"return\", this);\n            case 2:\n              options = this[kOptions];\n              if (!options.tls) {\n                _context4.next = 27;\n                break;\n              }\n              if (!(typeof options.tlsCAFile === 'string')) {\n                _context4.next = 12;\n                break;\n              }\n              if (!((_options$ca = options.ca) !== null && _options$ca !== void 0)) {\n                _context4.next = 9;\n                break;\n              }\n              _options$ca;\n              _context4.next = 12;\n              break;\n            case 9:\n              _context4.next = 11;\n              return fs_1.promises.readFile(options.tlsCAFile);\n            case 11:\n              options.ca = _context4.sent;\n            case 12:\n              if (!(typeof options.tlsCRLFile === 'string')) {\n                _context4.next = 20;\n                break;\n              }\n              if (!((_options$crl = options.crl) !== null && _options$crl !== void 0)) {\n                _context4.next = 17;\n                break;\n              }\n              _options$crl;\n              _context4.next = 20;\n              break;\n            case 17:\n              _context4.next = 19;\n              return fs_1.promises.readFile(options.tlsCRLFile);\n            case 19:\n              options.crl = _context4.sent;\n            case 20:\n              if (!(typeof options.tlsCertificateKeyFile === 'string')) {\n                _context4.next = 27;\n                break;\n              }\n              if (!(!options.key || !options.cert)) {\n                _context4.next = 27;\n                break;\n              }\n              _context4.next = 24;\n              return fs_1.promises.readFile(options.tlsCertificateKeyFile);\n            case 24:\n              contents = _context4.sent;\n              (_options$key = options.key) !== null && _options$key !== void 0 ? _options$key : options.key = contents;\n              (_options$cert = options.cert) !== null && _options$cert !== void 0 ? _options$cert : options.cert = contents;\n            case 27:\n              if (!(typeof options.srvHost === 'string')) {\n                _context4.next = 33;\n                break;\n              }\n              _context4.next = 30;\n              return (0, connection_string_1.resolveSRVRecord)(options);\n            case 30:\n              hosts = _context4.sent;\n              _iterator = _createForOfIteratorHelper(hosts.entries());\n              try {\n                for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                  _step$value = _slicedToArray(_step.value, 2), index = _step$value[0], host = _step$value[1];\n                  options.hosts[index] = host;\n                }\n              } catch (err) {\n                _iterator.e(err);\n              } finally {\n                _iterator.f();\n              }\n            case 33:\n              if (!(((_options$credentials = options.credentials) === null || _options$credentials === void 0 ? void 0 : _options$credentials.mechanism) === providers_1.AuthMechanism.MONGODB_OIDC)) {\n                _context4.next = 54;\n                break;\n              }\n              allowedHosts = ((_options$credentials2 = options.credentials) === null || _options$credentials2 === void 0 || (_options$credentials2 = _options$credentials2.mechanismProperties) === null || _options$credentials2 === void 0 ? void 0 : _options$credentials2.ALLOWED_HOSTS) || mongo_credentials_1.DEFAULT_ALLOWED_HOSTS;\n              isServiceAuth = !!((_options$credentials3 = options.credentials) !== null && _options$credentials3 !== void 0 && (_options$credentials3 = _options$credentials3.mechanismProperties) !== null && _options$credentials3 !== void 0 && _options$credentials3.PROVIDER_NAME);\n              if (isServiceAuth) {\n                _context4.next = 54;\n                break;\n              }\n              _iterator2 = _createForOfIteratorHelper(options.hosts);\n              _context4.prev = 38;\n              _iterator2.s();\n            case 40:\n              if ((_step2 = _iterator2.n()).done) {\n                _context4.next = 46;\n                break;\n              }\n              _host = _step2.value;\n              if ((0, utils_1.hostMatchesWildcards)(_host.toHostPort().host, allowedHosts)) {\n                _context4.next = 44;\n                break;\n              }\n              throw new error_1.MongoInvalidArgumentError(\"Host '\".concat(_host, \"' is not valid for OIDC authentication with ALLOWED_HOSTS of '\").concat(allowedHosts.join(','), \"'\"));\n            case 44:\n              _context4.next = 40;\n              break;\n            case 46:\n              _context4.next = 51;\n              break;\n            case 48:\n              _context4.prev = 48;\n              _context4.t0 = _context4[\"catch\"](38);\n              _iterator2.e(_context4.t0);\n            case 51:\n              _context4.prev = 51;\n              _iterator2.f();\n              return _context4.finish(51);\n            case 54:\n              this.topology = new topology_1.Topology(this, options.hosts, options);\n              // Events can be emitted before initialization is complete so we have to\n              // save the reference to the topology on the client ASAP if the event handlers need to access it\n              this.topology.once(topology_1.Topology.OPEN, function () {\n                return _this2.emit('open', _this2);\n              });\n              _iterator3 = _createForOfIteratorHelper(constants_1.MONGO_CLIENT_EVENTS);\n              _context4.prev = 57;\n              _loop = /*#__PURE__*/_regeneratorRuntime().mark(function _loop() {\n                var event;\n                return _regeneratorRuntime().wrap(function _loop$(_context3) {\n                  while (1) switch (_context3.prev = _context3.next) {\n                    case 0:\n                      event = _step3.value;\n                      _this2.topology.on(event, function () {\n                        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n                          args[_key] = arguments[_key];\n                        }\n                        return _this2.emit.apply(_this2, [event].concat(args));\n                      });\n                    case 2:\n                    case \"end\":\n                      return _context3.stop();\n                  }\n                }, _loop);\n              });\n              _iterator3.s();\n            case 60:\n              if ((_step3 = _iterator3.n()).done) {\n                _context4.next = 64;\n                break;\n              }\n              return _context4.delegateYield(_loop(), \"t1\", 62);\n            case 62:\n              _context4.next = 60;\n              break;\n            case 64:\n              _context4.next = 69;\n              break;\n            case 66:\n              _context4.prev = 66;\n              _context4.t2 = _context4[\"catch\"](57);\n              _iterator3.e(_context4.t2);\n            case 69:\n              _context4.prev = 69;\n              _iterator3.f();\n              return _context4.finish(69);\n            case 72:\n              topologyConnect = /*#__PURE__*/function () {\n                var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n                  var _this2$topology2;\n                  return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n                    while (1) switch (_context2.prev = _context2.next) {\n                      case 0:\n                        _context2.prev = 0;\n                        _context2.next = 3;\n                        return (0, util_1.promisify)(function (callback) {\n                          var _this2$topology;\n                          return (_this2$topology = _this2.topology) === null || _this2$topology === void 0 ? void 0 : _this2$topology.connect(options, callback);\n                        })();\n                      case 3:\n                        _context2.next = 9;\n                        break;\n                      case 5:\n                        _context2.prev = 5;\n                        _context2.t0 = _context2[\"catch\"](0);\n                        (_this2$topology2 = _this2.topology) === null || _this2$topology2 === void 0 || _this2$topology2.close({\n                          force: true\n                        });\n                        throw _context2.t0;\n                      case 9:\n                      case \"end\":\n                        return _context2.stop();\n                    }\n                  }, _callee2, null, [[0, 5]]);\n                }));\n                return function topologyConnect() {\n                  return _ref.apply(this, arguments);\n                };\n              }();\n              if (!this.autoEncrypter) {\n                _context4.next = 82;\n                break;\n              }\n              _context4.next = 76;\n              return (_this$autoEncrypter = this.autoEncrypter) === null || _this$autoEncrypter === void 0 ? void 0 : _this$autoEncrypter.init();\n            case 76:\n              _context4.next = 78;\n              return topologyConnect();\n            case 78:\n              _context4.next = 80;\n              return options.encrypter.connectInternalClient();\n            case 80:\n              _context4.next = 84;\n              break;\n            case 82:\n              _context4.next = 84;\n              return topologyConnect();\n            case 84:\n              return _context4.abrupt(\"return\", this);\n            case 85:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee3, this, [[38, 48, 51, 54], [57, 66, 69, 72]]);\n      }));\n      function _connect() {\n        return _connect3.apply(this, arguments);\n      }\n      return _connect;\n    }()\n    /**\n     * Close the client and its underlying connections\n     *\n     * @param force - Force close, emitting no events\n     */\n  }, {\n    key: \"close\",\n    value: function () {\n      var _close = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        var _this3 = this;\n        var force,\n          activeSessionEnds,\n          selector,\n          topologyDescription,\n          serverDescriptions,\n          servers,\n          endSessions,\n          topology,\n          _args5 = arguments;\n        return _regeneratorRuntime().wrap(function _callee4$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              force = _args5.length > 0 && _args5[0] !== undefined ? _args5[0] : false;\n              // There's no way to set hasBeenClosed back to false\n              Object.defineProperty(this.s, 'hasBeenClosed', {\n                value: true,\n                enumerable: true,\n                configurable: false,\n                writable: false\n              });\n              activeSessionEnds = Array.from(this.s.activeSessions, function (session) {\n                return session.endSession();\n              });\n              this.s.activeSessions.clear();\n              _context5.next = 6;\n              return Promise.all(activeSessionEnds);\n            case 6:\n              if (!(this.topology == null)) {\n                _context5.next = 8;\n                break;\n              }\n              return _context5.abrupt(\"return\");\n            case 8:\n              // If we would attempt to select a server and get nothing back we short circuit\n              // to avoid the server selection timeout.\n              selector = (0, server_selection_1.readPreferenceServerSelector)(read_preference_1.ReadPreference.primaryPreferred);\n              topologyDescription = this.topology.description;\n              serverDescriptions = Array.from(topologyDescription.servers.values());\n              servers = selector(topologyDescription, serverDescriptions);\n              if (!(servers.length !== 0)) {\n                _context5.next = 17;\n                break;\n              }\n              endSessions = Array.from(this.s.sessionPool.sessions, function (_ref2) {\n                var id = _ref2.id;\n                return id;\n              });\n              if (!(endSessions.length !== 0)) {\n                _context5.next = 17;\n                break;\n              }\n              _context5.next = 17;\n              return (0, execute_operation_1.executeOperation)(this, new run_command_1.RunAdminCommandOperation({\n                endSessions: endSessions\n              }, {\n                readPreference: read_preference_1.ReadPreference.primaryPreferred,\n                noResponse: true\n              })).catch(function () {\n                return null;\n              });\n            case 17:\n              // clear out references to old topology\n              topology = this.topology;\n              this.topology = undefined;\n              _context5.next = 21;\n              return new Promise(function (resolve, reject) {\n                topology.close({\n                  force: force\n                }, function (error) {\n                  if (error) return reject(error);\n                  var encrypter = _this3[kOptions].encrypter;\n                  if (encrypter) {\n                    return encrypter.closeCallback(_this3, force, function (error) {\n                      if (error) return reject(error);\n                      resolve();\n                    });\n                  }\n                  resolve();\n                });\n              });\n            case 21:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee4, this);\n      }));\n      function close() {\n        return _close.apply(this, arguments);\n      }\n      return close;\n    }()\n    /**\n     * Create a new Db instance sharing the current socket connections.\n     *\n     * @param dbName - The name of the database we want to use. If not provided, use database name from connection string.\n     * @param options - Optional settings for Db construction\n     */\n  }, {\n    key: \"db\",\n    value: function db(dbName, options) {\n      var _options;\n      options = (_options = options) !== null && _options !== void 0 ? _options : {};\n      // Default to db from connection string if not provided\n      if (!dbName) {\n        dbName = this.options.dbName;\n      }\n      // Copy the options and add out internal override of the not shared flag\n      var finalOptions = Object.assign({}, this[kOptions], options);\n      // Return the db object\n      var db = new db_1.Db(this, dbName, finalOptions);\n      // Return the database\n      return db;\n    }\n    /**\n     * Connect to MongoDB using a url\n     *\n     * @remarks\n     * The programmatically provided options take precedence over the URI options.\n     *\n     * @see https://www.mongodb.com/docs/manual/reference/connection-string/\n     */\n  }, {\n    key: \"startSession\",\n    value:\n    /**\n     * Creates a new ClientSession. When using the returned session in an operation\n     * a corresponding ServerSession will be created.\n     *\n     * @remarks\n     * A ClientSession instance may only be passed to operations being performed on the same\n     * MongoClient it was started from.\n     */\n    function startSession(options) {\n      var _this4 = this;\n      var session = new sessions_1.ClientSession(this, this.s.sessionPool, _objectSpread({\n        explicit: true\n      }, options), this[kOptions]);\n      this.s.activeSessions.add(session);\n      session.once('ended', function () {\n        _this4.s.activeSessions.delete(session);\n      });\n      return session;\n    }\n  }, {\n    key: \"withSession\",\n    value: function () {\n      var _withSession = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(optionsOrExecutor, executor) {\n        var options, withSessionCallback, session;\n        return _regeneratorRuntime().wrap(function _callee5$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              options = _objectSpread({\n                // Always define an owner\n                owner: Symbol()\n              }, typeof optionsOrExecutor === 'object' ? optionsOrExecutor : {});\n              withSessionCallback = typeof optionsOrExecutor === 'function' ? optionsOrExecutor : executor;\n              if (!(withSessionCallback == null)) {\n                _context6.next = 4;\n                break;\n              }\n              throw new error_1.MongoInvalidArgumentError('Missing required callback parameter');\n            case 4:\n              session = this.startSession(options);\n              _context6.prev = 5;\n              _context6.next = 8;\n              return withSessionCallback(session);\n            case 8:\n              return _context6.abrupt(\"return\", _context6.sent);\n            case 9:\n              _context6.prev = 9;\n              _context6.prev = 10;\n              _context6.next = 13;\n              return session.endSession();\n            case 13:\n              _context6.next = 17;\n              break;\n            case 15:\n              _context6.prev = 15;\n              _context6.t0 = _context6[\"catch\"](10);\n            case 17:\n              return _context6.finish(9);\n            case 18:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee5, this, [[5,, 9, 18], [10, 15]]);\n      }));\n      function withSession(_x, _x2) {\n        return _withSession.apply(this, arguments);\n      }\n      return withSession;\n    }()\n    /**\n     * Create a new Change Stream, watching for new changes (insertions, updates,\n     * replacements, deletions, and invalidations) in this cluster. Will ignore all\n     * changes to system collections, as well as the local, admin, and config databases.\n     *\n     * @remarks\n     * watch() accepts two generic arguments for distinct use cases:\n     * - The first is to provide the schema that may be defined for all the data within the current cluster\n     * - The second is to override the shape of the change stream document entirely, if it is not provided the type will default to ChangeStreamDocument of the first argument\n     *\n     * @param pipeline - An array of {@link https://www.mongodb.com/docs/manual/reference/operator/aggregation-pipeline/|aggregation pipeline stages} through which to pass change stream documents. This allows for filtering (using $match) and manipulating the change stream documents.\n     * @param options - Optional settings for the command\n     * @typeParam TSchema - Type of the data being detected by the change stream\n     * @typeParam TChange - Type of the whole change stream document emitted\n     */\n  }, {\n    key: \"watch\",\n    value: function watch() {\n      var pipeline = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      // Allow optionally not specifying a pipeline\n      if (!Array.isArray(pipeline)) {\n        options = pipeline;\n        pipeline = [];\n      }\n      return new change_stream_1.ChangeStream(this, pipeline, (0, utils_1.resolveOptions)(this, options));\n    }\n  }], [{\n    key: \"connect\",\n    value: function () {\n      var _connect4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(url, options) {\n        var client;\n        return _regeneratorRuntime().wrap(function _callee6$(_context7) {\n          while (1) switch (_context7.prev = _context7.next) {\n            case 0:\n              client = new this(url, options);\n              return _context7.abrupt(\"return\", client.connect());\n            case 2:\n            case \"end\":\n              return _context7.stop();\n          }\n        }, _callee6, this);\n      }));\n      function connect(_x3, _x4) {\n        return _connect4.apply(this, arguments);\n      }\n      return connect;\n    }()\n  }]);\n  return MongoClient;\n}(mongo_types_1.TypedEventEmitter);\nexports.MongoClient = MongoClient;","map":{"version":3,"names":["fs_1","require","util_1","bson_1","change_stream_1","mongo_credentials_1","providers_1","connection_string_1","constants_1","db_1","error_1","mongo_logger_1","mongo_types_1","execute_operation_1","run_command_1","read_preference_1","server_selection_1","topology_1","sessions_1","utils_1","exports","ServerApiVersion","Object","freeze","v1","kOptions","Symbol","MongoClient","_mongo_types_1$TypedE","_inherits","_super","_createSuper","url","options","_this","_classCallCheck","call","parseOptions","_assertThisInitialized","mongoLogger","MongoLogger","mongoLoggerOptions","client","s","bsonOptions","resolveBSONOptions","namespace","ns","hasBeenClosed","sessionPool","ServerSessionPool","activeSessions","Set","readConcern","writeConcern","readPreference","isMongoClient","_createClass","key","get","_objectSpread","serverApi","monitorCommands","set","value","autoEncrypter","_connect2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","connectionLock","abrupt","_connect","undefined","finish","stop","connect","apply","arguments","_connect3","_callee3","_options$credentials","_this2","_options$ca","_options$crl","_options$key","_options$cert","contents","hosts","_iterator","_step","_step$value","index","host","_options$credentials2","_options$credentials3","allowedHosts","isServiceAuth","_iterator2","_step2","_host","_iterator3","_step3","_loop","topologyConnect","_this$autoEncrypter","_callee3$","_context4","topology","isConnected","tls","tlsCAFile","ca","promises","readFile","sent","tlsCRLFile","crl","tlsCertificateKeyFile","cert","srvHost","resolveSRVRecord","_createForOfIteratorHelper","entries","n","done","_slicedToArray","err","e","f","credentials","mechanism","AuthMechanism","MONGODB_OIDC","mechanismProperties","ALLOWED_HOSTS","DEFAULT_ALLOWED_HOSTS","PROVIDER_NAME","hostMatchesWildcards","toHostPort","MongoInvalidArgumentError","concat","join","t0","Topology","once","OPEN","emit","MONGO_CLIENT_EVENTS","event","_loop$","_context3","on","_len","length","args","Array","_key","delegateYield","t2","_ref","_callee2","_this2$topology2","_callee2$","_context2","promisify","callback","_this2$topology","close","force","init","encrypter","connectInternalClient","_close","_callee4","_this3","activeSessionEnds","selector","topologyDescription","serverDescriptions","servers","endSessions","_args5","_callee4$","_context5","defineProperty","enumerable","configurable","writable","from","session","endSession","clear","Promise","all","readPreferenceServerSelector","ReadPreference","primaryPreferred","description","values","sessions","_ref2","id","executeOperation","RunAdminCommandOperation","noResponse","catch","resolve","reject","error","closeCallback","db","dbName","_options","finalOptions","assign","Db","startSession","_this4","ClientSession","explicit","add","delete","_withSession","_callee5","optionsOrExecutor","executor","withSessionCallback","_callee5$","_context6","owner","withSession","_x","_x2","watch","pipeline","isArray","ChangeStream","resolveOptions","_connect4","_callee6","_callee6$","_context7","_x3","_x4","TypedEventEmitter"],"sources":["C:\\Users\\raphm\\Documents\\Projects\\youtube-transcript\\youtube-transcript\\node_modules\\mongodb\\src\\mongo_client.ts"],"sourcesContent":["import { promises as fs } from 'fs';\nimport type { TcpNetConnectOpts } from 'net';\nimport type { ConnectionOptions as TLSConnectionOptions, TLSSocketOptions } from 'tls';\nimport { promisify } from 'util';\n\nimport { type BSONSerializeOptions, type Document, resolveBSONOptions } from './bson';\nimport { ChangeStream, type ChangeStreamDocument, type ChangeStreamOptions } from './change_stream';\nimport type { AutoEncrypter, AutoEncryptionOptions } from './client-side-encryption/auto_encrypter';\nimport {\n  type AuthMechanismProperties,\n  DEFAULT_ALLOWED_HOSTS,\n  type MongoCredentials\n} from './cmap/auth/mongo_credentials';\nimport { AuthMechanism } from './cmap/auth/providers';\nimport type { LEGAL_TCP_SOCKET_OPTIONS, LEGAL_TLS_SOCKET_OPTIONS } from './cmap/connect';\nimport type { Connection } from './cmap/connection';\nimport type { ClientMetadata } from './cmap/handshake/client_metadata';\nimport type { CompressorName } from './cmap/wire_protocol/compression';\nimport { parseOptions, resolveSRVRecord } from './connection_string';\nimport { MONGO_CLIENT_EVENTS } from './constants';\nimport { Db, type DbOptions } from './db';\nimport type { Encrypter } from './encrypter';\nimport { MongoInvalidArgumentError } from './error';\nimport { MongoLogger, type MongoLoggerOptions } from './mongo_logger';\nimport { TypedEventEmitter } from './mongo_types';\nimport { executeOperation } from './operations/execute_operation';\nimport { RunAdminCommandOperation } from './operations/run_command';\nimport type { ReadConcern, ReadConcernLevel, ReadConcernLike } from './read_concern';\nimport { ReadPreference, type ReadPreferenceMode } from './read_preference';\nimport type { TagSet } from './sdam/server_description';\nimport { readPreferenceServerSelector } from './sdam/server_selection';\nimport type { SrvPoller } from './sdam/srv_polling';\nimport { Topology, type TopologyEvents } from './sdam/topology';\nimport { ClientSession, type ClientSessionOptions, ServerSessionPool } from './sessions';\nimport {\n  type HostAddress,\n  hostMatchesWildcards,\n  type MongoDBNamespace,\n  ns,\n  resolveOptions\n} from './utils';\nimport type { W, WriteConcern, WriteConcernSettings } from './write_concern';\n\n/** @public */\nexport const ServerApiVersion = Object.freeze({\n  v1: '1'\n} as const);\n\n/** @public */\nexport type ServerApiVersion = (typeof ServerApiVersion)[keyof typeof ServerApiVersion];\n\n/** @public */\nexport interface ServerApi {\n  version: ServerApiVersion;\n  strict?: boolean;\n  deprecationErrors?: boolean;\n}\n\n/** @public */\nexport interface DriverInfo {\n  name?: string;\n  version?: string;\n  platform?: string;\n}\n\n/** @public */\nexport interface Auth {\n  /** The username for auth */\n  username?: string;\n  /** The password for auth */\n  password?: string;\n}\n\n/** @public */\nexport interface PkFactory {\n  createPk(): any; // TODO: when js-bson is typed, function should return some BSON type\n}\n\n/** @public */\nexport type SupportedTLSConnectionOptions = Pick<\n  TLSConnectionOptions,\n  Extract<keyof TLSConnectionOptions, (typeof LEGAL_TLS_SOCKET_OPTIONS)[number]>\n>;\n\n/** @public */\nexport type SupportedTLSSocketOptions = Pick<\n  TLSSocketOptions,\n  Extract<keyof TLSSocketOptions, (typeof LEGAL_TLS_SOCKET_OPTIONS)[number]>\n>;\n\n/** @public */\nexport type SupportedSocketOptions = Pick<\n  TcpNetConnectOpts,\n  (typeof LEGAL_TCP_SOCKET_OPTIONS)[number]\n>;\n\n/** @public */\nexport type SupportedNodeConnectionOptions = SupportedTLSConnectionOptions &\n  SupportedTLSSocketOptions &\n  SupportedSocketOptions;\n\n/**\n * Describes all possible URI query options for the mongo client\n * @public\n * @see https://www.mongodb.com/docs/manual/reference/connection-string\n */\nexport interface MongoClientOptions extends BSONSerializeOptions, SupportedNodeConnectionOptions {\n  /** Specifies the name of the replica set, if the mongod is a member of a replica set. */\n  replicaSet?: string;\n  /** Enables or disables TLS/SSL for the connection. */\n  tls?: boolean;\n  /** A boolean to enable or disables TLS/SSL for the connection. (The ssl option is equivalent to the tls option.) */\n  ssl?: boolean;\n  /** Specifies the location of a local .pem file that contains either the client's TLS/SSL certificate and key. */\n  tlsCertificateKeyFile?: string;\n  /** Specifies the password to de-crypt the tlsCertificateKeyFile. */\n  tlsCertificateKeyFilePassword?: string;\n  /** Specifies the location of a local .pem file that contains the root certificate chain from the Certificate Authority. This file is used to validate the certificate presented by the mongod/mongos instance. */\n  tlsCAFile?: string;\n  /** Specifies the location of a local CRL .pem file that contains the client revokation list. */\n  tlsCRLFile?: string;\n  /** Bypasses validation of the certificates presented by the mongod/mongos instance */\n  tlsAllowInvalidCertificates?: boolean;\n  /** Disables hostname validation of the certificate presented by the mongod/mongos instance. */\n  tlsAllowInvalidHostnames?: boolean;\n  /** Disables various certificate validations. */\n  tlsInsecure?: boolean;\n  /** The time in milliseconds to attempt a connection before timing out. */\n  connectTimeoutMS?: number;\n  /** The time in milliseconds to attempt a send or receive on a socket before the attempt times out. */\n  socketTimeoutMS?: number;\n  /** An array or comma-delimited string of compressors to enable network compression for communication between this client and a mongod/mongos instance. */\n  compressors?: CompressorName[] | string;\n  /** An integer that specifies the compression level if using zlib for network compression. */\n  zlibCompressionLevel?: 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | undefined;\n  /** The maximum number of hosts to connect to when using an srv connection string, a setting of `0` means unlimited hosts */\n  srvMaxHosts?: number;\n  /**\n   * Modifies the srv URI to look like:\n   *\n   * `_{srvServiceName}._tcp.{hostname}.{domainname}`\n   *\n   * Querying this DNS URI is expected to respond with SRV records\n   */\n  srvServiceName?: string;\n  /** The maximum number of connections in the connection pool. */\n  maxPoolSize?: number;\n  /** The minimum number of connections in the connection pool. */\n  minPoolSize?: number;\n  /** The maximum number of connections that may be in the process of being established concurrently by the connection pool. */\n  maxConnecting?: number;\n  /** The maximum number of milliseconds that a connection can remain idle in the pool before being removed and closed. */\n  maxIdleTimeMS?: number;\n  /** The maximum time in milliseconds that a thread can wait for a connection to become available. */\n  waitQueueTimeoutMS?: number;\n  /** Specify a read concern for the collection (only MongoDB 3.2 or higher supported) */\n  readConcern?: ReadConcernLike;\n  /** The level of isolation */\n  readConcernLevel?: ReadConcernLevel;\n  /** Specifies the read preferences for this connection */\n  readPreference?: ReadPreferenceMode | ReadPreference;\n  /** Specifies, in seconds, how stale a secondary can be before the client stops using it for read operations. */\n  maxStalenessSeconds?: number;\n  /** Specifies the tags document as a comma-separated list of colon-separated key-value pairs.  */\n  readPreferenceTags?: TagSet[];\n  /** The auth settings for when connection to server. */\n  auth?: Auth;\n  /** Specify the database name associated with the userâ€™s credentials. */\n  authSource?: string;\n  /** Specify the authentication mechanism that MongoDB will use to authenticate the connection. */\n  authMechanism?: AuthMechanism;\n  /** Specify properties for the specified authMechanism as a comma-separated list of colon-separated key-value pairs. */\n  authMechanismProperties?: AuthMechanismProperties;\n  /** The size (in milliseconds) of the latency window for selecting among multiple suitable MongoDB instances. */\n  localThresholdMS?: number;\n  /** Specifies how long (in milliseconds) to block for server selection before throwing an exception.  */\n  serverSelectionTimeoutMS?: number;\n  /** heartbeatFrequencyMS controls when the driver checks the state of the MongoDB deployment. Specify the interval (in milliseconds) between checks, counted from the end of the previous check until the beginning of the next one. */\n  heartbeatFrequencyMS?: number;\n  /** Sets the minimum heartbeat frequency. In the event that the driver has to frequently re-check a server's availability, it will wait at least this long since the previous check to avoid wasted effort. */\n  minHeartbeatFrequencyMS?: number;\n  /** The name of the application that created this MongoClient instance. MongoDB 3.4 and newer will print this value in the server log upon establishing each connection. It is also recorded in the slow query log and profile collections */\n  appName?: string;\n  /** Enables retryable reads. */\n  retryReads?: boolean;\n  /** Enable retryable writes. */\n  retryWrites?: boolean;\n  /** Allow a driver to force a Single topology type with a connection string containing one host */\n  directConnection?: boolean;\n  /** Instruct the driver it is connecting to a load balancer fronting a mongos like service */\n  loadBalanced?: boolean;\n  /**\n   * The write concern w value\n   * @deprecated Please use the `writeConcern` option instead\n   */\n  w?: W;\n  /**\n   * The write concern timeout\n   * @deprecated Please use the `writeConcern` option instead\n   */\n  wtimeoutMS?: number;\n  /**\n   * The journal write concern\n   * @deprecated Please use the `writeConcern` option instead\n   */\n  journal?: boolean;\n  /**\n   * A MongoDB WriteConcern, which describes the level of acknowledgement\n   * requested from MongoDB for write operations.\n   *\n   * @see https://www.mongodb.com/docs/manual/reference/write-concern/\n   */\n  writeConcern?: WriteConcern | WriteConcernSettings;\n  /** TCP Connection no delay */\n  noDelay?: boolean;\n  /** Force server to assign `_id` values instead of driver */\n  forceServerObjectId?: boolean;\n  /** A primary key factory function for generation of custom `_id` keys */\n  pkFactory?: PkFactory;\n  /** Enable command monitoring for this client */\n  monitorCommands?: boolean;\n  /** Server API version */\n  serverApi?: ServerApi | ServerApiVersion;\n  /**\n   * Optionally enable in-use auto encryption\n   *\n   * @remarks\n   *  Automatic encryption is an enterprise only feature that only applies to operations on a collection. Automatic encryption is not supported for operations on a database or view, and operations that are not bypassed will result in error\n   *  (see [libmongocrypt: Auto Encryption Allow-List](https://github.com/mongodb/specifications/blob/master/source/client-side-encryption/client-side-encryption.rst#libmongocrypt-auto-encryption-allow-list)). To bypass automatic encryption for all operations, set bypassAutoEncryption=true in AutoEncryptionOpts.\n   *\n   *  Automatic encryption requires the authenticated user to have the [listCollections privilege action](https://www.mongodb.com/docs/manual/reference/command/listCollections/#dbcmd.listCollections).\n   *\n   *  If a MongoClient with a limited connection pool size (i.e a non-zero maxPoolSize) is configured with AutoEncryptionOptions, a separate internal MongoClient is created if any of the following are true:\n   *  - AutoEncryptionOptions.keyVaultClient is not passed.\n   *  - AutoEncryptionOptions.bypassAutomaticEncryption is false.\n   *\n   * If an internal MongoClient is created, it is configured with the same options as the parent MongoClient except minPoolSize is set to 0 and AutoEncryptionOptions is omitted.\n   */\n  autoEncryption?: AutoEncryptionOptions;\n  /** Allows a wrapping driver to amend the client metadata generated by the driver to include information about the wrapping driver */\n  driverInfo?: DriverInfo;\n  /** Configures a Socks5 proxy host used for creating TCP connections. */\n  proxyHost?: string;\n  /** Configures a Socks5 proxy port used for creating TCP connections. */\n  proxyPort?: number;\n  /** Configures a Socks5 proxy username when the proxy in proxyHost requires username/password authentication. */\n  proxyUsername?: string;\n  /** Configures a Socks5 proxy password when the proxy in proxyHost requires username/password authentication. */\n  proxyPassword?: string;\n\n  /** @internal */\n  srvPoller?: SrvPoller;\n  /** @internal */\n  connectionType?: typeof Connection;\n\n  /** @internal */\n  [featureFlag: symbol]: any;\n}\n\n/** @public */\nexport type WithSessionCallback<T = unknown> = (session: ClientSession) => Promise<T>;\n\n/** @internal */\nexport interface MongoClientPrivate {\n  url: string;\n  bsonOptions: BSONSerializeOptions;\n  namespace: MongoDBNamespace;\n  hasBeenClosed: boolean;\n  /**\n   * We keep a reference to the sessions that are acquired from the pool.\n   * - used to track and close all sessions in client.close() (which is non-standard behavior)\n   * - used to notify the leak checker in our tests if test author forgot to clean up explicit sessions\n   */\n  readonly activeSessions: Set<ClientSession>;\n  readonly sessionPool: ServerSessionPool;\n  readonly options: MongoOptions;\n  readonly readConcern?: ReadConcern;\n  readonly writeConcern?: WriteConcern;\n  readonly readPreference: ReadPreference;\n  readonly isMongoClient: true;\n}\n\n/** @public */\nexport type MongoClientEvents = Pick<TopologyEvents, (typeof MONGO_CLIENT_EVENTS)[number]> & {\n  // In previous versions the open event emitted a topology, in an effort to no longer\n  // expose internals but continue to expose this useful event API, it now emits a mongoClient\n  open(mongoClient: MongoClient): void;\n};\n\n/** @internal */\nconst kOptions = Symbol('options');\n\n/**\n * The **MongoClient** class is a class that allows for making Connections to MongoDB.\n * @public\n *\n * @remarks\n * The programmatically provided options take precedence over the URI options.\n *\n * @example\n * ```ts\n * import { MongoClient } from 'mongodb';\n *\n * // Enable command monitoring for debugging\n * const client = new MongoClient('mongodb://localhost:27017', { monitorCommands: true });\n *\n * client.on('commandStarted', started => console.log(started));\n * client.db().collection('pets');\n * await client.insertOne({ name: 'spot', kind: 'dog' });\n * ```\n */\nexport class MongoClient extends TypedEventEmitter<MongoClientEvents> {\n  /** @internal */\n  s: MongoClientPrivate;\n  /** @internal */\n  topology?: Topology;\n  /** @internal */\n  override readonly mongoLogger: MongoLogger;\n  /** @internal */\n  private connectionLock?: Promise<this>;\n\n  /**\n   * The consolidate, parsed, transformed and merged options.\n   * @internal\n   */\n  [kOptions]: MongoOptions;\n\n  constructor(url: string, options?: MongoClientOptions) {\n    super();\n\n    this[kOptions] = parseOptions(url, this, options);\n    this.mongoLogger = new MongoLogger(this[kOptions].mongoLoggerOptions);\n\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const client = this;\n\n    // The internal state\n    this.s = {\n      url,\n      bsonOptions: resolveBSONOptions(this[kOptions]),\n      namespace: ns('admin'),\n      hasBeenClosed: false,\n      sessionPool: new ServerSessionPool(this),\n      activeSessions: new Set(),\n\n      get options() {\n        return client[kOptions];\n      },\n      get readConcern() {\n        return client[kOptions].readConcern;\n      },\n      get writeConcern() {\n        return client[kOptions].writeConcern;\n      },\n      get readPreference() {\n        return client[kOptions].readPreference;\n      },\n      get isMongoClient(): true {\n        return true;\n      }\n    };\n  }\n\n  /** @see MongoOptions */\n  get options(): Readonly<MongoOptions> {\n    return Object.freeze({ ...this[kOptions] });\n  }\n\n  get serverApi(): Readonly<ServerApi | undefined> {\n    return this[kOptions].serverApi && Object.freeze({ ...this[kOptions].serverApi });\n  }\n  /**\n   * Intended for APM use only\n   * @internal\n   */\n  get monitorCommands(): boolean {\n    return this[kOptions].monitorCommands;\n  }\n  set monitorCommands(value: boolean) {\n    this[kOptions].monitorCommands = value;\n  }\n\n  /** @internal */\n  get autoEncrypter(): AutoEncrypter | undefined {\n    return this[kOptions].autoEncrypter;\n  }\n\n  get readConcern(): ReadConcern | undefined {\n    return this.s.readConcern;\n  }\n\n  get writeConcern(): WriteConcern | undefined {\n    return this.s.writeConcern;\n  }\n\n  get readPreference(): ReadPreference {\n    return this.s.readPreference;\n  }\n\n  get bsonOptions(): BSONSerializeOptions {\n    return this.s.bsonOptions;\n  }\n\n  /**\n   * Connect to MongoDB using a url\n   *\n   * @see docs.mongodb.org/manual/reference/connection-string/\n   */\n  async connect(): Promise<this> {\n    if (this.connectionLock) {\n      return this.connectionLock;\n    }\n\n    try {\n      this.connectionLock = this._connect();\n      await this.connectionLock;\n    } finally {\n      // release\n      this.connectionLock = undefined;\n    }\n\n    return this;\n  }\n\n  /**\n   * Create a topology to open the connection, must be locked to avoid topology leaks in concurrency scenario.\n   * Locking is enforced by the connect method.\n   *\n   * @internal\n   */\n  private async _connect(): Promise<this> {\n    if (this.topology && this.topology.isConnected()) {\n      return this;\n    }\n\n    const options = this[kOptions];\n\n    if (options.tls) {\n      if (typeof options.tlsCAFile === 'string') {\n        options.ca ??= await fs.readFile(options.tlsCAFile);\n      }\n      if (typeof options.tlsCRLFile === 'string') {\n        options.crl ??= await fs.readFile(options.tlsCRLFile);\n      }\n      if (typeof options.tlsCertificateKeyFile === 'string') {\n        if (!options.key || !options.cert) {\n          const contents = await fs.readFile(options.tlsCertificateKeyFile);\n          options.key ??= contents;\n          options.cert ??= contents;\n        }\n      }\n    }\n    if (typeof options.srvHost === 'string') {\n      const hosts = await resolveSRVRecord(options);\n\n      for (const [index, host] of hosts.entries()) {\n        options.hosts[index] = host;\n      }\n    }\n\n    // It is important to perform validation of hosts AFTER SRV resolution, to check the real hostname,\n    // but BEFORE we even attempt connecting with a potentially not allowed hostname\n    if (options.credentials?.mechanism === AuthMechanism.MONGODB_OIDC) {\n      const allowedHosts =\n        options.credentials?.mechanismProperties?.ALLOWED_HOSTS || DEFAULT_ALLOWED_HOSTS;\n      const isServiceAuth = !!options.credentials?.mechanismProperties?.PROVIDER_NAME;\n      if (!isServiceAuth) {\n        for (const host of options.hosts) {\n          if (!hostMatchesWildcards(host.toHostPort().host, allowedHosts)) {\n            throw new MongoInvalidArgumentError(\n              `Host '${host}' is not valid for OIDC authentication with ALLOWED_HOSTS of '${allowedHosts.join(\n                ','\n              )}'`\n            );\n          }\n        }\n      }\n    }\n\n    this.topology = new Topology(this, options.hosts, options);\n    // Events can be emitted before initialization is complete so we have to\n    // save the reference to the topology on the client ASAP if the event handlers need to access it\n\n    this.topology.once(Topology.OPEN, () => this.emit('open', this));\n\n    for (const event of MONGO_CLIENT_EVENTS) {\n      this.topology.on(event, (...args: any[]) => this.emit(event, ...(args as any)));\n    }\n\n    const topologyConnect = async () => {\n      try {\n        await promisify(callback => this.topology?.connect(options, callback))();\n      } catch (error) {\n        this.topology?.close({ force: true });\n        throw error;\n      }\n    };\n\n    if (this.autoEncrypter) {\n      await this.autoEncrypter?.init();\n      await topologyConnect();\n      await options.encrypter.connectInternalClient();\n    } else {\n      await topologyConnect();\n    }\n\n    return this;\n  }\n\n  /**\n   * Close the client and its underlying connections\n   *\n   * @param force - Force close, emitting no events\n   */\n  async close(force = false): Promise<void> {\n    // There's no way to set hasBeenClosed back to false\n    Object.defineProperty(this.s, 'hasBeenClosed', {\n      value: true,\n      enumerable: true,\n      configurable: false,\n      writable: false\n    });\n\n    const activeSessionEnds = Array.from(this.s.activeSessions, session => session.endSession());\n    this.s.activeSessions.clear();\n\n    await Promise.all(activeSessionEnds);\n\n    if (this.topology == null) {\n      return;\n    }\n\n    // If we would attempt to select a server and get nothing back we short circuit\n    // to avoid the server selection timeout.\n    const selector = readPreferenceServerSelector(ReadPreference.primaryPreferred);\n    const topologyDescription = this.topology.description;\n    const serverDescriptions = Array.from(topologyDescription.servers.values());\n    const servers = selector(topologyDescription, serverDescriptions);\n    if (servers.length !== 0) {\n      const endSessions = Array.from(this.s.sessionPool.sessions, ({ id }) => id);\n      if (endSessions.length !== 0) {\n        await executeOperation(\n          this,\n          new RunAdminCommandOperation(\n            { endSessions },\n            { readPreference: ReadPreference.primaryPreferred, noResponse: true }\n          )\n        ).catch(() => null); // outcome does not matter;\n      }\n    }\n\n    // clear out references to old topology\n    const topology = this.topology;\n    this.topology = undefined;\n\n    await new Promise<void>((resolve, reject) => {\n      topology.close({ force }, error => {\n        if (error) return reject(error);\n        const { encrypter } = this[kOptions];\n        if (encrypter) {\n          return encrypter.closeCallback(this, force, error => {\n            if (error) return reject(error);\n            resolve();\n          });\n        }\n        resolve();\n      });\n    });\n  }\n\n  /**\n   * Create a new Db instance sharing the current socket connections.\n   *\n   * @param dbName - The name of the database we want to use. If not provided, use database name from connection string.\n   * @param options - Optional settings for Db construction\n   */\n  db(dbName?: string, options?: DbOptions): Db {\n    options = options ?? {};\n\n    // Default to db from connection string if not provided\n    if (!dbName) {\n      dbName = this.options.dbName;\n    }\n\n    // Copy the options and add out internal override of the not shared flag\n    const finalOptions = Object.assign({}, this[kOptions], options);\n\n    // Return the db object\n    const db = new Db(this, dbName, finalOptions);\n\n    // Return the database\n    return db;\n  }\n\n  /**\n   * Connect to MongoDB using a url\n   *\n   * @remarks\n   * The programmatically provided options take precedence over the URI options.\n   *\n   * @see https://www.mongodb.com/docs/manual/reference/connection-string/\n   */\n  static async connect(url: string, options?: MongoClientOptions): Promise<MongoClient> {\n    const client = new this(url, options);\n    return client.connect();\n  }\n\n  /**\n   * Creates a new ClientSession. When using the returned session in an operation\n   * a corresponding ServerSession will be created.\n   *\n   * @remarks\n   * A ClientSession instance may only be passed to operations being performed on the same\n   * MongoClient it was started from.\n   */\n  startSession(options?: ClientSessionOptions): ClientSession {\n    const session = new ClientSession(\n      this,\n      this.s.sessionPool,\n      { explicit: true, ...options },\n      this[kOptions]\n    );\n    this.s.activeSessions.add(session);\n    session.once('ended', () => {\n      this.s.activeSessions.delete(session);\n    });\n    return session;\n  }\n\n  /**\n   * A convenience method for creating and handling the clean up of a ClientSession.\n   * The session will always be ended when the executor finishes.\n   *\n   * @param executor - An executor function that all operations using the provided session must be invoked in\n   * @param options - optional settings for the session\n   */\n  async withSession<T = any>(executor: WithSessionCallback<T>): Promise<T>;\n  async withSession<T = any>(\n    options: ClientSessionOptions,\n    executor: WithSessionCallback<T>\n  ): Promise<T>;\n  async withSession<T = any>(\n    optionsOrExecutor: ClientSessionOptions | WithSessionCallback<T>,\n    executor?: WithSessionCallback<T>\n  ): Promise<T> {\n    const options = {\n      // Always define an owner\n      owner: Symbol(),\n      // If it's an object inherit the options\n      ...(typeof optionsOrExecutor === 'object' ? optionsOrExecutor : {})\n    };\n\n    const withSessionCallback =\n      typeof optionsOrExecutor === 'function' ? optionsOrExecutor : executor;\n\n    if (withSessionCallback == null) {\n      throw new MongoInvalidArgumentError('Missing required callback parameter');\n    }\n\n    const session = this.startSession(options);\n\n    try {\n      return await withSessionCallback(session);\n    } finally {\n      try {\n        await session.endSession();\n      } catch {\n        // We are not concerned with errors from endSession()\n      }\n    }\n  }\n\n  /**\n   * Create a new Change Stream, watching for new changes (insertions, updates,\n   * replacements, deletions, and invalidations) in this cluster. Will ignore all\n   * changes to system collections, as well as the local, admin, and config databases.\n   *\n   * @remarks\n   * watch() accepts two generic arguments for distinct use cases:\n   * - The first is to provide the schema that may be defined for all the data within the current cluster\n   * - The second is to override the shape of the change stream document entirely, if it is not provided the type will default to ChangeStreamDocument of the first argument\n   *\n   * @param pipeline - An array of {@link https://www.mongodb.com/docs/manual/reference/operator/aggregation-pipeline/|aggregation pipeline stages} through which to pass change stream documents. This allows for filtering (using $match) and manipulating the change stream documents.\n   * @param options - Optional settings for the command\n   * @typeParam TSchema - Type of the data being detected by the change stream\n   * @typeParam TChange - Type of the whole change stream document emitted\n   */\n  watch<\n    TSchema extends Document = Document,\n    TChange extends Document = ChangeStreamDocument<TSchema>\n  >(pipeline: Document[] = [], options: ChangeStreamOptions = {}): ChangeStream<TSchema, TChange> {\n    // Allow optionally not specifying a pipeline\n    if (!Array.isArray(pipeline)) {\n      options = pipeline;\n      pipeline = [];\n    }\n\n    return new ChangeStream<TSchema, TChange>(this, pipeline, resolveOptions(this, options));\n  }\n}\n\n/**\n * Parsed Mongo Client Options.\n *\n * User supplied options are documented by `MongoClientOptions`.\n *\n * **NOTE:** The client's options parsing is subject to change to support new features.\n * This type is provided to aid with inspection of options after parsing, it should not be relied upon programmatically.\n *\n * Options are sourced from:\n * - connection string\n * - options object passed to the MongoClient constructor\n * - file system (ex. tls settings)\n * - environment variables\n * - DNS SRV records and TXT records\n *\n * Not all options may be present after client construction as some are obtained from asynchronous operations.\n *\n * @public\n */\nexport interface MongoOptions\n  extends Required<\n      Pick<\n        MongoClientOptions,\n        | 'autoEncryption'\n        | 'connectTimeoutMS'\n        | 'directConnection'\n        | 'driverInfo'\n        | 'forceServerObjectId'\n        | 'minHeartbeatFrequencyMS'\n        | 'heartbeatFrequencyMS'\n        | 'localThresholdMS'\n        | 'maxConnecting'\n        | 'maxIdleTimeMS'\n        | 'maxPoolSize'\n        | 'minPoolSize'\n        | 'monitorCommands'\n        | 'noDelay'\n        | 'pkFactory'\n        | 'raw'\n        | 'replicaSet'\n        | 'retryReads'\n        | 'retryWrites'\n        | 'serverSelectionTimeoutMS'\n        | 'socketTimeoutMS'\n        | 'srvMaxHosts'\n        | 'srvServiceName'\n        | 'tlsAllowInvalidCertificates'\n        | 'tlsAllowInvalidHostnames'\n        | 'tlsInsecure'\n        | 'waitQueueTimeoutMS'\n        | 'zlibCompressionLevel'\n      >\n    >,\n    SupportedNodeConnectionOptions {\n  appName?: string;\n  hosts: HostAddress[];\n  srvHost?: string;\n  credentials?: MongoCredentials;\n  readPreference: ReadPreference;\n  readConcern: ReadConcern;\n  loadBalanced: boolean;\n  serverApi: ServerApi;\n  compressors: CompressorName[];\n  writeConcern: WriteConcern;\n  dbName: string;\n  metadata: ClientMetadata;\n  /** @internal */\n  autoEncrypter?: AutoEncrypter;\n  proxyHost?: string;\n  proxyPort?: number;\n  proxyUsername?: string;\n  proxyPassword?: string;\n\n  /** @internal */\n  connectionType?: typeof Connection;\n\n  /** @internal */\n  encrypter: Encrypter;\n  /** @internal */\n  userSpecifiedAuthSource: boolean;\n  /** @internal */\n  userSpecifiedReplicaSet: boolean;\n\n  /**\n   * # NOTE ABOUT TLS Options\n   *\n   * If `tls` is provided as an option, it is equivalent to setting the `ssl` option.\n   *\n   * NodeJS native TLS options are passed through to the socket and retain their original types.\n   *\n   * ### Additional options:\n   *\n   * | nodejs native option  | driver spec equivalent option name            | driver option type |\n   * |:----------------------|:----------------------------------------------|:-------------------|\n   * | `ca`                  | `tlsCAFile`                                   | `string`           |\n   * | `crl`                 | `tlsCRLFile`                                  | `string`           |\n   * | `cert`                | `tlsCertificateKeyFile`                       | `string`           |\n   * | `key`                 | `tlsCertificateKeyFile`                       | `string`           |\n   * | `passphrase`          | `tlsCertificateKeyFilePassword`               | `string`           |\n   * | `rejectUnauthorized`  | `tlsAllowInvalidCertificates`                 | `boolean`          |\n   * | `checkServerIdentity` | `tlsAllowInvalidHostnames`                    | `boolean`          |\n   * | see note below        | `tlsInsecure`                                 | `boolean`          |\n   *\n   * If `tlsInsecure` is set to `true`, then it will set the node native options `checkServerIdentity`\n   * to a no-op and `rejectUnauthorized` to `false`.\n   *\n   * If `tlsInsecure` is set to `false`, then it will set the node native options `checkServerIdentity`\n   * to a no-op and `rejectUnauthorized` to the inverse value of `tlsAllowInvalidCertificates`. If\n   * `tlsAllowInvalidCertificates` is not set, then `rejectUnauthorized` will be set to `true`.\n   *\n   * ### Note on `tlsCAFile`, `tlsCertificateKeyFile` and `tlsCRLFile`\n   *\n   * The files specified by the paths passed in to the `tlsCAFile`, `tlsCertificateKeyFile` and `tlsCRLFile`\n   * fields are read lazily on the first call to `MongoClient.connect`. Once these files have been read and\n   * the `ca`, `cert`, `crl` and `key` fields are populated, they will not be read again on subsequent calls to\n   * `MongoClient.connect`. As a result, until the first call to `MongoClient.connect`, the `ca`,\n   * `cert`, `crl` and `key` fields will be undefined.\n   */\n  tls: boolean;\n  tlsCAFile?: string;\n  tlsCRLFile?: string;\n  tlsCertificateKeyFile?: string;\n\n  /** @internal */\n  [featureFlag: symbol]: any;\n\n  /** @internal */\n  mongoLoggerOptions: MongoLoggerOptions;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}