{"ast":null,"code":"'use strict';\n\nconst {\n  constants: BufferConstants\n} = require('buffer');\nconst stream = require('stream');\nconst {\n  promisify\n} = require('util');\nconst bufferStream = require('./buffer-stream');\nconst streamPipelinePromisified = promisify(stream.pipeline);\nclass MaxBufferError extends Error {\n  constructor() {\n    super('maxBuffer exceeded');\n    this.name = 'MaxBufferError';\n  }\n}\nasync function getStream(inputStream, options) {\n  if (!inputStream) {\n    throw new Error('Expected a stream');\n  }\n  options = {\n    maxBuffer: Infinity,\n    ...options\n  };\n  const {\n    maxBuffer\n  } = options;\n  const stream = bufferStream(options);\n  await new Promise((resolve, reject) => {\n    const rejectPromise = error => {\n      // Don't retrieve an oversized buffer.\n      if (error && stream.getBufferedLength() <= BufferConstants.MAX_LENGTH) {\n        error.bufferedData = stream.getBufferedValue();\n      }\n      reject(error);\n    };\n    (async () => {\n      try {\n        await streamPipelinePromisified(inputStream, stream);\n        resolve();\n      } catch (error) {\n        rejectPromise(error);\n      }\n    })();\n    stream.on('data', () => {\n      if (stream.getBufferedLength() > maxBuffer) {\n        rejectPromise(new MaxBufferError());\n      }\n    });\n  });\n  return stream.getBufferedValue();\n}\nmodule.exports = getStream;\nmodule.exports.buffer = (stream, options) => getStream(stream, {\n  ...options,\n  encoding: 'buffer'\n});\nmodule.exports.array = (stream, options) => getStream(stream, {\n  ...options,\n  array: true\n});\nmodule.exports.MaxBufferError = MaxBufferError;","map":{"version":3,"names":["constants","BufferConstants","require","stream","promisify","bufferStream","streamPipelinePromisified","pipeline","MaxBufferError","Error","constructor","name","getStream","inputStream","options","maxBuffer","Infinity","Promise","resolve","reject","rejectPromise","error","getBufferedLength","MAX_LENGTH","bufferedData","getBufferedValue","on","module","exports","buffer","encoding","array"],"sources":["C:/Users/raphm/Documents/Projects/youtube-transcript/youtube-transcript/node_modules/get-stream/index.js"],"sourcesContent":["'use strict';\nconst {constants: BufferConstants} = require('buffer');\nconst stream = require('stream');\nconst {promisify} = require('util');\nconst bufferStream = require('./buffer-stream');\n\nconst streamPipelinePromisified = promisify(stream.pipeline);\n\nclass MaxBufferError extends Error {\n\tconstructor() {\n\t\tsuper('maxBuffer exceeded');\n\t\tthis.name = 'MaxBufferError';\n\t}\n}\n\nasync function getStream(inputStream, options) {\n\tif (!inputStream) {\n\t\tthrow new Error('Expected a stream');\n\t}\n\n\toptions = {\n\t\tmaxBuffer: Infinity,\n\t\t...options\n\t};\n\n\tconst {maxBuffer} = options;\n\tconst stream = bufferStream(options);\n\n\tawait new Promise((resolve, reject) => {\n\t\tconst rejectPromise = error => {\n\t\t\t// Don't retrieve an oversized buffer.\n\t\t\tif (error && stream.getBufferedLength() <= BufferConstants.MAX_LENGTH) {\n\t\t\t\terror.bufferedData = stream.getBufferedValue();\n\t\t\t}\n\n\t\t\treject(error);\n\t\t};\n\n\t\t(async () => {\n\t\t\ttry {\n\t\t\t\tawait streamPipelinePromisified(inputStream, stream);\n\t\t\t\tresolve();\n\t\t\t} catch (error) {\n\t\t\t\trejectPromise(error);\n\t\t\t}\n\t\t})();\n\n\t\tstream.on('data', () => {\n\t\t\tif (stream.getBufferedLength() > maxBuffer) {\n\t\t\t\trejectPromise(new MaxBufferError());\n\t\t\t}\n\t\t});\n\t});\n\n\treturn stream.getBufferedValue();\n}\n\nmodule.exports = getStream;\nmodule.exports.buffer = (stream, options) => getStream(stream, {...options, encoding: 'buffer'});\nmodule.exports.array = (stream, options) => getStream(stream, {...options, array: true});\nmodule.exports.MaxBufferError = MaxBufferError;\n"],"mappings":"AAAA,YAAY;;AACZ,MAAM;EAACA,SAAS,EAAEC;AAAe,CAAC,GAAGC,OAAO,CAAC,QAAQ,CAAC;AACtD,MAAMC,MAAM,GAAGD,OAAO,CAAC,QAAQ,CAAC;AAChC,MAAM;EAACE;AAAS,CAAC,GAAGF,OAAO,CAAC,MAAM,CAAC;AACnC,MAAMG,YAAY,GAAGH,OAAO,CAAC,iBAAiB,CAAC;AAE/C,MAAMI,yBAAyB,GAAGF,SAAS,CAACD,MAAM,CAACI,QAAQ,CAAC;AAE5D,MAAMC,cAAc,SAASC,KAAK,CAAC;EAClCC,WAAWA,CAAA,EAAG;IACb,KAAK,CAAC,oBAAoB,CAAC;IAC3B,IAAI,CAACC,IAAI,GAAG,gBAAgB;EAC7B;AACD;AAEA,eAAeC,SAASA,CAACC,WAAW,EAAEC,OAAO,EAAE;EAC9C,IAAI,CAACD,WAAW,EAAE;IACjB,MAAM,IAAIJ,KAAK,CAAC,mBAAmB,CAAC;EACrC;EAEAK,OAAO,GAAG;IACTC,SAAS,EAAEC,QAAQ;IACnB,GAAGF;EACJ,CAAC;EAED,MAAM;IAACC;EAAS,CAAC,GAAGD,OAAO;EAC3B,MAAMX,MAAM,GAAGE,YAAY,CAACS,OAAO,CAAC;EAEpC,MAAM,IAAIG,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtC,MAAMC,aAAa,GAAGC,KAAK,IAAI;MAC9B;MACA,IAAIA,KAAK,IAAIlB,MAAM,CAACmB,iBAAiB,CAAC,CAAC,IAAIrB,eAAe,CAACsB,UAAU,EAAE;QACtEF,KAAK,CAACG,YAAY,GAAGrB,MAAM,CAACsB,gBAAgB,CAAC,CAAC;MAC/C;MAEAN,MAAM,CAACE,KAAK,CAAC;IACd,CAAC;IAED,CAAC,YAAY;MACZ,IAAI;QACH,MAAMf,yBAAyB,CAACO,WAAW,EAAEV,MAAM,CAAC;QACpDe,OAAO,CAAC,CAAC;MACV,CAAC,CAAC,OAAOG,KAAK,EAAE;QACfD,aAAa,CAACC,KAAK,CAAC;MACrB;IACD,CAAC,EAAE,CAAC;IAEJlB,MAAM,CAACuB,EAAE,CAAC,MAAM,EAAE,MAAM;MACvB,IAAIvB,MAAM,CAACmB,iBAAiB,CAAC,CAAC,GAAGP,SAAS,EAAE;QAC3CK,aAAa,CAAC,IAAIZ,cAAc,CAAC,CAAC,CAAC;MACpC;IACD,CAAC,CAAC;EACH,CAAC,CAAC;EAEF,OAAOL,MAAM,CAACsB,gBAAgB,CAAC,CAAC;AACjC;AAEAE,MAAM,CAACC,OAAO,GAAGhB,SAAS;AAC1Be,MAAM,CAACC,OAAO,CAACC,MAAM,GAAG,CAAC1B,MAAM,EAAEW,OAAO,KAAKF,SAAS,CAACT,MAAM,EAAE;EAAC,GAAGW,OAAO;EAAEgB,QAAQ,EAAE;AAAQ,CAAC,CAAC;AAChGH,MAAM,CAACC,OAAO,CAACG,KAAK,GAAG,CAAC5B,MAAM,EAAEW,OAAO,KAAKF,SAAS,CAACT,MAAM,EAAE;EAAC,GAAGW,OAAO;EAAEiB,KAAK,EAAE;AAAI,CAAC,CAAC;AACxFJ,MAAM,CAACC,OAAO,CAACpB,cAAc,GAAGA,cAAc"},"metadata":{},"sourceType":"script","externalDependencies":[]}