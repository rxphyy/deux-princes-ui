{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"C:/Users/raphm/Documents/Projects/youtube-transcript/youtube-transcript/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\").default;\nvar _asyncToGenerator = require(\"C:/Users/raphm/Documents/Projects/youtube-transcript/youtube-transcript/node_modules/@babel/runtime/helpers/asyncToGenerator.js\").default;\nvar _classCallCheck = require(\"C:/Users/raphm/Documents/Projects/youtube-transcript/youtube-transcript/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\nvar _createClass = require(\"C:/Users/raphm/Documents/Projects/youtube-transcript/youtube-transcript/node_modules/@babel/runtime/helpers/createClass.js\").default;\nvar _get = require(\"C:/Users/raphm/Documents/Projects/youtube-transcript/youtube-transcript/node_modules/@babel/runtime/helpers/get.js\").default;\nvar _getPrototypeOf = require(\"C:/Users/raphm/Documents/Projects/youtube-transcript/youtube-transcript/node_modules/@babel/runtime/helpers/getPrototypeOf.js\").default;\nvar _inherits = require(\"C:/Users/raphm/Documents/Projects/youtube-transcript/youtube-transcript/node_modules/@babel/runtime/helpers/inherits.js\").default;\nvar _createSuper = require(\"C:/Users/raphm/Documents/Projects/youtube-transcript/youtube-transcript/node_modules/@babel/runtime/helpers/createSuper.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ValidateCollectionOperation = void 0;\nvar error_1 = require(\"../error\");\nvar command_1 = require(\"./command\");\n/** @internal */\nvar ValidateCollectionOperation = /*#__PURE__*/function (_command_1$CommandOpe) {\n  _inherits(ValidateCollectionOperation, _command_1$CommandOpe);\n  var _super = _createSuper(ValidateCollectionOperation);\n  function ValidateCollectionOperation(admin, collectionName, options) {\n    var _this;\n    _classCallCheck(this, ValidateCollectionOperation);\n    // Decorate command with extra options\n    var command = {\n      validate: collectionName\n    };\n    var keys = Object.keys(options);\n    for (var i = 0; i < keys.length; i++) {\n      if (Object.prototype.hasOwnProperty.call(options, keys[i]) && keys[i] !== 'session') {\n        command[keys[i]] = options[keys[i]];\n      }\n    }\n    _this = _super.call(this, admin.s.db, options);\n    _this.options = options;\n    _this.command = command;\n    _this.collectionName = collectionName;\n    return _this;\n  }\n  _createClass(ValidateCollectionOperation, [{\n    key: \"execute\",\n    value: function () {\n      var _execute = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(server, session) {\n        var collectionName, doc;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              collectionName = this.collectionName;\n              _context.next = 3;\n              return _get(_getPrototypeOf(ValidateCollectionOperation.prototype), \"executeCommand\", this).call(this, server, session, this.command);\n            case 3:\n              doc = _context.sent;\n              if (!(doc.result != null && typeof doc.result !== 'string')) {\n                _context.next = 6;\n                break;\n              }\n              throw new error_1.MongoUnexpectedServerResponseError('Error with validation data');\n            case 6:\n              if (!(doc.result != null && doc.result.match(/exception|corrupt/) != null)) {\n                _context.next = 8;\n                break;\n              }\n              throw new error_1.MongoUnexpectedServerResponseError(\"Invalid collection \".concat(collectionName));\n            case 8:\n              if (!(doc.valid != null && !doc.valid)) {\n                _context.next = 10;\n                break;\n              }\n              throw new error_1.MongoUnexpectedServerResponseError(\"Invalid collection \".concat(collectionName));\n            case 10:\n              return _context.abrupt(\"return\", doc);\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function execute(_x, _x2) {\n        return _execute.apply(this, arguments);\n      }\n      return execute;\n    }()\n  }]);\n  return ValidateCollectionOperation;\n}(command_1.CommandOperation);\nexports.ValidateCollectionOperation = ValidateCollectionOperation;","map":{"version":3,"names":["error_1","require","command_1","ValidateCollectionOperation","_command_1$CommandOpe","_inherits","_super","_createSuper","admin","collectionName","options","_this","_classCallCheck","command","validate","keys","Object","i","length","prototype","hasOwnProperty","call","s","db","_createClass","key","value","_execute","_asyncToGenerator","_regeneratorRuntime","mark","_callee","server","session","doc","wrap","_callee$","_context","prev","next","_get","_getPrototypeOf","sent","result","MongoUnexpectedServerResponseError","match","concat","valid","abrupt","stop","execute","_x","_x2","apply","arguments","CommandOperation","exports"],"sources":["C:\\Users\\raphm\\Documents\\Projects\\youtube-transcript\\youtube-transcript\\node_modules\\mongodb\\src\\operations\\validate_collection.ts"],"sourcesContent":["import type { Admin } from '../admin';\nimport type { Document } from '../bson';\nimport { MongoUnexpectedServerResponseError } from '../error';\nimport type { Server } from '../sdam/server';\nimport type { ClientSession } from '../sessions';\nimport { CommandOperation, type CommandOperationOptions } from './command';\n\n/** @public */\nexport interface ValidateCollectionOptions extends CommandOperationOptions {\n  /** Validates a collection in the background, without interrupting read or write traffic (only in MongoDB 4.4+) */\n  background?: boolean;\n}\n\n/** @internal */\nexport class ValidateCollectionOperation extends CommandOperation<Document> {\n  override options: ValidateCollectionOptions;\n  collectionName: string;\n  command: Document;\n\n  constructor(admin: Admin, collectionName: string, options: ValidateCollectionOptions) {\n    // Decorate command with extra options\n    const command: Document = { validate: collectionName };\n    const keys = Object.keys(options);\n    for (let i = 0; i < keys.length; i++) {\n      if (Object.prototype.hasOwnProperty.call(options, keys[i]) && keys[i] !== 'session') {\n        command[keys[i]] = (options as Document)[keys[i]];\n      }\n    }\n\n    super(admin.s.db, options);\n    this.options = options;\n    this.command = command;\n    this.collectionName = collectionName;\n  }\n\n  override async execute(server: Server, session: ClientSession | undefined): Promise<Document> {\n    const collectionName = this.collectionName;\n\n    const doc = await super.executeCommand(server, session, this.command);\n    if (doc.result != null && typeof doc.result !== 'string')\n      throw new MongoUnexpectedServerResponseError('Error with validation data');\n    if (doc.result != null && doc.result.match(/exception|corrupt/) != null)\n      throw new MongoUnexpectedServerResponseError(`Invalid collection ${collectionName}`);\n    if (doc.valid != null && !doc.valid)\n      throw new MongoUnexpectedServerResponseError(`Invalid collection ${collectionName}`);\n\n    return doc;\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}